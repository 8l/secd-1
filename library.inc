(NEG LAMBDA (N)
  (SUB (QUOTE 0) N))
(ABS LAMBDA (N)
  (IF (LEQ N (QUOTE 0)) (NEG N) N))
(NOT LAMBDA (P)
  (IF P (QUOTE F) (QUOTE T)))
(AND LAMBDA (P Q)
  (IF P Q (QUOTE F)))
(OR LAMBDA (P Q)
  (IF P (QUOTE T) Q))
(XOR LAMBDA (P Q)
  (IF P (NOT Q) Q))
(ISBOOLEAN LAMBDA (P)
  (OR (EQ P (QUOTE T)) (EQ P (QUOTE F))))
(ISNIL LAMBDA (X)
  (EQ X (QUOTE NIL)))
(ISZERO LAMBDA (N)
  (EQ N (QUOTE 0)))
(LT LAMBDA (A B)
  (AND (LEQ A B) (NOT (EQ A B))))
(GEQ LAMBDA (A B)
  (LEQ B A))
(GT LAMBDA (A B)
  (LT B A))
(NEQ LAMBDA (A B)
  (NOT (EQ A B)))
(CAAR LAMBDA (X)
  (CAR (CAR X)))
(CADR LAMBDA (X)
  (CAR (CDR X)))
(CDAR LAMBDA (X)
  (CDR (CAR X)))
(CDDR LAMBDA (X)
  (CDR (CDR X)))
(APPEND LAMBDA (X Y)
  (IF (EQ X (QUOTE NIL))
      Y
      (CONS (CAR X)
        (APPEND (CDR X) Y))))
(SUM LAMBDA (X)
  (IF (ISNIL X)
      (QUOTE 0)
      (ADD (CAR X) (SUM (CDR X)))))
(FACTORIAL LAMBDA (N)
  (IF (ISZERO N)
      (QUOTE 1)
      (MUL N (FACTORIAL (SUB N (QUOTE 1))))))
(RANGE LAMBDA (A B)
  (IF (GT A B)
      (QUOTE NIL)
      (CONS A (RANGE (ADD A (QUOTE 1)) B))))
(FOREACH LAMBDA (X FN)
  (IF (ISNIL X)
      X
      (CONS (FN (CAR X)) (FOREACH (CDR X) FN))))
(POW LAMBDA (X N)
  (IF (ISZERO N)
      (QUOTE 1)
      (MUL X (POW X (SUB N (QUOTE 1))))))
(FIB LAMBDA (N)
  (IF (LEQ N (QUOTE 0))
      (QUOTE NIL)
      (IF (EQ N (QUOTE 1))
          (QUOTE (1))
          (IF (EQ N (QUOTE 2))
              (QUOTE (1 1))
              (LET (CONS (ADD (CAR REM) (CADR REM)) REM)
                   (REM FIB (SUB N (QUOTE 1))))))))
